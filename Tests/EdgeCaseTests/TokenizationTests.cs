using AI.ClassicMath.Calculator.ProcessorLogic;
using System;
using System.Linq;

namespace EdgeCaseTests;

/// <summary>
/// –ú–û–©–ù–´–ï —Ç–µ—Å—Ç—ã —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤
/// </summary>
class TokenizationTests
{
    static int passedTests = 0;
    static int failedTests = 0;
    static int totalTests = 0;

    static void TestString(string testName, string script, string expectedString)
    {
        totalTests++;
        try
        {
            var processor = new Processor();
            var output = processor.Run(script);
            var hasError = output.Any(line => line.Contains("–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê") || line.Contains("–û–®–ò–ë–ö–ê"));

            if (hasError)
            {
                failedTests++;
                Console.WriteLine($"‚ùå {testName}");
                Console.WriteLine($"   –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:");
                foreach (var line in output)
                {
                    Console.WriteLine($"   {line}");
                }
                return;
            }

            string? actualString = null;
            foreach (var line in output)
            {
                if (line.Contains("=>"))
                {
                    var parts = line.Split(new[] { "=>" }, StringSplitOptions.None);
                    if (parts.Length >= 2)
                    {
                        actualString = parts[1].Trim();
                        var bracketIndex = actualString.IndexOf('[');
                        if (bracketIndex > 0)
                        {
                            actualString = actualString.Substring(0, bracketIndex).Trim();
                        }
                    }
                }
            }

            bool passed = actualString == expectedString;

            if (passed)
            {
                passedTests++;
                Console.WriteLine($"‚úÖ {testName}");
            }
            else
            {
                failedTests++;
                Console.WriteLine($"‚ùå {testName}");
                Console.WriteLine($"   –û–∂–∏–¥–∞–ª–æ—Å—å: \"{expectedString}\"");
                Console.WriteLine($"   –ü–æ–ª—É—á–µ–Ω–æ:  \"{actualString}\"");
            }
        }
        catch (Exception ex)
        {
            failedTests++;
            Console.WriteLine($"‚ùå {testName}");
            Console.WriteLine($"   Exception: {ex.Message}");
        }
    }

    static void TestNumber(string testName, string script, double expected, double precision = 1e-8)
    {
        totalTests++;
        try
        {
            var processor = new Processor();
            var output = processor.Run(script);
            var hasError = output.Any(line => line.Contains("–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê") || line.Contains("–û–®–ò–ë–ö–ê"));

            if (hasError)
            {
                failedTests++;
                Console.WriteLine($"‚ùå {testName}");
                Console.WriteLine($"   –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:");
                foreach (var line in output)
                {
                    Console.WriteLine($"   {line}");
                }
                return;
            }

            double? actual = null;
            foreach (var line in output)
            {
                if (line.Contains("=>"))
                {
                    var parts = line.Split(new[] { "=>" }, StringSplitOptions.None);
                    if (parts.Length >= 2)
                    {
                        var valueStr = parts[1].Trim().Split(new[] { ' ', '[' })[0];
                        if (double.TryParse(valueStr, System.Globalization.NumberStyles.Any, 
                            System.Globalization.CultureInfo.InvariantCulture, out var val))
                        {
                            actual = val;
                        }
                    }
                }
            }

            bool passed = actual.HasValue && Math.Abs(actual.Value - expected) < precision;

            if (passed)
            {
                passedTests++;
                Console.WriteLine($"‚úÖ {testName}");
            }
            else
            {
                failedTests++;
                Console.WriteLine($"‚ùå {testName}");
                Console.WriteLine($"   –û–∂–∏–¥–∞–ª–æ—Å—å: {expected}");
                Console.WriteLine($"   –ü–æ–ª—É—á–µ–Ω–æ:  {actual}");
            }
        }
        catch (Exception ex)
        {
            failedTests++;
            Console.WriteLine($"‚ùå {testName}");
            Console.WriteLine($"   Exception: {ex.Message}");
        }
    }

    static void Main(string[] args)
    {
        Console.WriteLine("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó");
        Console.WriteLine("‚ïë  –ú–û–©–ù–´–ï –¢–ï–°–¢–´ –¢–û–ö–ï–ù–ò–ó–ê–¶–ò–ò –ò –ó–ê–†–ï–ó–ï–†–í–ò–†–û–í–ê–ù–ù–´–• –°–õ–û–í          ‚ïë");
        Console.WriteLine("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n");

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 1: –ó–ê–†–ï–ó–ï–†–í–ò–†–û–í–ê–ù–ù–´–ï –°–õ–û–í–ê –í –°–¢–†–û–ö–ê–• ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestString("–°—Ç—Ä–æ–∫–∞ 'and'",
            @"s = ""and""
s",
            "and");

        TestString("–°—Ç—Ä–æ–∫–∞ 'or'",
            @"s = ""or""
s",
            "or");

        TestString("–°—Ç—Ä–æ–∫–∞ 'not'",
            @"s = ""not""
s",
            "not");

        TestString("–°—Ç—Ä–æ–∫–∞ 'if'",
            @"s = ""if""
s",
            "if");

        TestString("–°—Ç—Ä–æ–∫–∞ 'else'",
            @"s = ""else""
s",
            "else");

        TestString("–°—Ç—Ä–æ–∫–∞ 'for'",
            @"s = ""for""
s",
            "for");

        TestString("–°—Ç—Ä–æ–∫–∞ 'while'",
            @"s = ""while""
s",
            "while");

        TestString("–°—Ç—Ä–æ–∫–∞ 'break'",
            @"s = ""break""
s",
            "break");

        TestString("–°—Ç—Ä–æ–∫–∞ 'continue'",
            @"s = ""continue""
s",
            "continue");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å AND –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—Å—Ç–∞",
            @"s = ""command""
s",
            "command");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å OR –≤–Ω—É—Ç—Ä–∏",
            @"s = ""error""
s",
            "error");

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("\n‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 2: –û–ü–ï–†–ê–¢–û–†–´ –í –°–¢–†–û–ö–ê–• ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestString("–°—Ç—Ä–æ–∫–∞ —Å +",
            @"s = ""a+b""
s",
            "a+b");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å -",
            @"s = ""x-y""
s",
            "x-y");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å *",
            @"s = ""2*3""
s",
            "2*3");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å /",
            @"s = ""10/5""
s",
            "10/5");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å =",
            @"s = ""a=b""
s",
            "a=b");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å ==",
            @"s = ""a==b""
s",
            "a==b");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å &&",
            @"s = ""a&&b""
s",
            "a&&b");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å ||",
            @"s = ""a||b""
s",
            "a||b");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å–æ —Å–∫–æ–±–∫–∞–º–∏",
            @"s = ""(x)""
s",
            "(x)");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–º–∏ —Å–∫–æ–±–∫–∞–º–∏",
            @"s = ""[array]""
s",
            "[array]");

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("\n‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 3: –°–†–ê–í–ù–ï–ù–ò–ï –°–¢–†–û–ö ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestNumber("–°—Ç—Ä–æ–∫–∏ —Ä–∞–≤–Ω—ã",
            @"s1 = ""test""
s2 = ""test""
s1 == s2",
            1.0);

        TestNumber("–°—Ç—Ä–æ–∫–∏ –ù–ï —Ä–∞–≤–Ω—ã",
            @"s1 = ""test""
s2 = ""other""
s1 == s2",
            0.0);

        TestNumber("–°—Ç—Ä–æ–∫–∏ –Ω–µ —Ä–∞–≤–Ω—ã (!=)",
            @"s1 = ""abc""
s2 = ""xyz""
s1 != s2",
            1.0);

        TestNumber("–ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ —Ä–∞–≤–Ω—ã",
            @"s1 = """"
s2 = """"
s1 == s2",
            1.0);

        TestNumber("–°—Ç—Ä–æ–∫–∞ —Å and == —Å—Ç—Ä–æ–∫–µ —Å and",
            @"s1 = ""and""
s2 = ""and""
s1 == s2",
            1.0);

        TestNumber("–°—Ç—Ä–æ–∫–∏ —Å # —Ä–∞–≤–Ω—ã",
            @"s1 = ""#test""
s2 = ""#test""
s1 == s2",
            1.0);

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("\n‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 4: CONCAT –° –ó–ê–†–ï–ó–ï–†–í–ò–†–û–í–ê–ù–ù–´–ú–ò –°–õ–û–í–ê–ú–ò ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestString("concat —Å 'and' (–ù–ï &&)",
            @"result = concat(""a"", "" & "", ""b"")
result",
            "a & b");

        TestString("concat —Å 'or'",
            @"result = concat(""true"", "" | "", ""false"")
result",
            "true | false");

        TestString("concat —Ç—Ä–µ—Ö 'and'",
            @"result = concat(""command"", "" & "", ""control"")
result",
            "command & control");

        TestString("concat —Å if –≤ —Å—Ç—Ä–æ–∫–µ",
            @"result = concat(""check "", ""if"", "" true"")
result",
            "check if true");

        TestString("concat —Å while –≤ —Å—Ç—Ä–æ–∫–µ",
            @"result = concat(""run "", ""while"", "" true"")
result",
            "run while true");

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("\n‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 5: –ú–ê–°–°–ò–í–´ –°–¢–†–û–ö –° –ó–ê–†–ï–ó–ï–†–í–ò–†–û–í–ê–ù–ù–´–ú–ò –°–õ–û–í–ê–ú–ò ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestString("–ú–∞—Å—Å–∏–≤ —Å 'and'",
            @"arr = [""and"", ""or"", ""not""]
index(arr, 0)",
            "and");

        TestString("–ú–∞—Å—Å–∏–≤ —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏",
            @"arr = [""+"", ""-"", ""*"", ""/""]
index(arr, 2)",
            "*");

        TestString("JOIN –º–∞—Å—Å–∏–≤–∞ —Å –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏",
            @"arr = [""if"", ""else"", ""for""]
join(arr, "" "")",
            "if else for");

        TestString("JOIN —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º 'and'",
            @"arr = [""one"", ""two"", ""three""]
join(arr, "" & "")",
            "one & two & three");

        TestString("–ú–∞—Å—Å–∏–≤ —Å –ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ —Å–ª–æ–≤–∞–º–∏",
            @"arr = [""true"", ""false"", ""null""]
join(arr, "","")  ",
            "true,false,null");

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("\n‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 6: –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –°–ò–ú–í–û–õ–´ –í –°–¢–†–û–ö–ê–• ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestString("–°—Ç—Ä–æ–∫–∞ —Å —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π",
            @"s = ""a;b;c""
s",
            "a;b;c");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å –¥–≤–æ–µ—Ç–æ—á–∏–µ–º",
            @"s = ""key:value""
s",
            "key:value");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π",
            @"s = ""a,b,c""
s",
            "a,b,c");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å –∫–∞–≤—ã—á–∫–∞–º–∏ –≤–Ω—É—Ç—Ä–∏ (escaped)",
            @"s = ""say \""hello\""""
s",
            "say \"hello\"");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏",
            @"s = ""   spaces   ""
len(s)",
            "13");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å —Ç–∞–±—É–ª—è—Ü–∏–µ–π",
            @"s = ""tab\there""
s",
            "tab\there");

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("\n‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 7: –°–õ–û–ñ–ù–´–ï –í–´–†–ê–ñ–ï–ù–ò–Ø –°–û –°–¢–†–û–ö–ê–ú–ò ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestString("IF —Å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º —Å—Ç—Ä–æ–∫",
            @"s = ""test""
result = """"
if s == ""test"":
    result = ""match""
else:
    result = ""no match""
result",
            "match");

        TestString("LOOP —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—Ç—Ä–æ–∫–∏",
            @"found = """"
arr = [""one"", ""two"", ""three""]
for i = 0 to 2:
    s = index(arr, i)
    if s == ""two"":
        found = ""yes""
found",
            "yes");

        TestNumber("–ü–æ–¥—Å—á–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å—Ç—Ä–æ–∫",
            @"arr = [""a"", ""b"", ""a"", ""c"", ""a""]
count = 0
for i = 0 to 4:
    if index(arr, i) == ""a"":
        count = count + 1
count",
            3.0);

        TestString("–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ –ø–æ —É—Å–ª–æ–≤–∏—é",
            @"arr = [""apple"", ""banana"", ""apricot""]
result = """"
for i = 0 to 2:
    s = index(arr, i)
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—É—é –±—É–∫–≤—É
    first = substr(s, 0, 1)
    if first == ""a"":
        result = concat(result, s, "" "")
result",
            "apple apricot ");

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("\n‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 8: –ì–†–ê–ù–ò–ß–ù–´–ï –°–õ–£–ß–ê–ò ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestString("–°—Ç—Ä–æ–∫–∞ —Ç–æ–ª—å–∫–æ –∏–∑ –ø—Ä–æ–±–µ–ª–æ–≤",
            @"s = ""     ""
len(s)",
            "5");

        TestString("–û—á–µ–Ω—å –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞",
            @"s = ""This is a very long string that contains many words and characters to test the tokenizer""
len(s)",
            "91");

        TestNumber("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫",
            @"s1 = """"
s2 = """"
s1 == s2",
            1.0);

        TestString("–°—Ç—Ä–æ–∫–∞ —Å —Ü–∏—Ñ—Ä–∞–º–∏",
            @"s = ""12345""
s",
            "12345");

        TestString("–°—Ç—Ä–æ–∫–∞ –ø–æ—Ö–æ–∂–∞—è –Ω–∞ —á–∏—Å–ª–æ",
            @"s = ""3.14""
s",
            "3.14");

        TestString("–°—Ç—Ä–æ–∫–∞ —Å –Ω–∞—É—á–Ω–æ–π –Ω–æ—Ç–∞—Ü–∏–µ–π",
            @"s = ""1e10""
s",
            "1e10");

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        Console.WriteLine("\n‚ïê‚ïê‚ïê –ì–†–£–ü–ü–ê 9: –°–ú–ï–®–ê–ù–ù–´–ï –û–ü–ï–†–ê–¶–ò–ò ‚ïê‚ïê‚ïê\n");
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        TestString("–°—Ç—Ä–æ–∫–∞ + —á–∏—Å–ª–æ —á–µ—Ä–µ–∑ concat",
            @"s = ""value: ""
n = 42
result = concat(s, ""42"")
result",
            "value: 42");

        TestString("–ú–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ –∏ —á–∏—Å–µ–ª (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ)",
            @"# –ù–ï–õ–¨–ó–Ø —Å–º–µ—à–∏–≤–∞—Ç—å —Ç–∏–ø—ã –≤ –º–∞—Å—Å–∏–≤–µ!
# –ù–æ –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫
arr = [""1"", ""2"", ""3""]
join(arr, "","")  ",
            "1,2,3");

        TestNumber("len —Å—Ç—Ä–æ–∫–∏ vs len –º–∞—Å—Å–∏–≤–∞",
            @"s = ""test""
arr = [1, 2, 3, 4]
len(s) + len(arr)",
            8.0);

        // –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        Console.WriteLine("\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó");
        Console.WriteLine($"‚ïë  –ò–¢–û–ì–ò: {passedTests}/{totalTests} —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ ({(passedTests * 100.0 / totalTests):F1}%)");
        Console.WriteLine($"‚ïë  ‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö: {passedTests}");
        Console.WriteLine($"‚ïë  ‚ùå –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: {failedTests}");
        Console.WriteLine("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n");

        if (failedTests > 0)
        {
            Console.WriteLine("‚ö†Ô∏è –ï—Å—Ç—å –Ω–µ–ø—Ä–æ—à–µ–¥—à–∏–µ —Ç–µ—Å—Ç—ã!");
            Environment.Exit(1);
        }
        else
        {
            Console.WriteLine("üéâ –í–°–ï –¢–ï–°–¢–´ –¢–û–ö–ï–ù–ò–ó–ê–¶–ò–ò –ü–†–û–ô–î–ï–ù–´!");
            Environment.Exit(0);
        }
    }
}

